<app-toolbar-farm></app-toolbar-farm>
<div class="container">
  <h1 class="title">EMERGENCY</h1>
  <form id="emergency-form" (ngSubmit)="onSubmit(form)" #form="ngForm">
    <div class="form-group">
      <label for="collaboratorId">Choose recipient:</label>
      <select id="collaboratorId" name="collaboratorId" [(ngModel)]="collaboratorId" required>
        <ng-container *ngIf="userRole === 'ROLE_FARMER'">
          <option *ngFor="let user of employees" [value]="user.id">{{ user.name }}</option>
        </ng-container>

          <option *ngIf="filteredUser" [value]="filteredUser.id">{{ filteredUser.username }}</option>
      </select>
    </div>
    <div class="form-group">
      <label for="description">Description:</label>
      <textarea id="description" name="description" [(ngModel)]="description" rows="4" required></textarea>
    </div>
    <div class="form-buttons">
      <button type="submit" class="btn btn-submit">Send</button>
      <button type="button" class="btn btn-cancel" (click)="form.resetForm()">Cancel</button>
    </div>
  </form>

  <h2 class="history-title">Messages Sent to Me</h2>
  <table class="history-table">
    <thead>
    <tr>
      <th>Sender</th>
      <th>Message</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let message of userMessages">
      <td>{{ getEmployeeNameById(message.collaboratorId) }}</td>
      <td>{{ message.description }}</td>
    </tr>
    </tbody>
  </table>
</div>
