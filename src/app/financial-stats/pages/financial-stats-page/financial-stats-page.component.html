<app-toolbar-farm></app-toolbar-farm>
<div class="container">
  <div class="summary">
    <mat-card class="summary-card">
      <mat-card-title class="summary-title">Financial Summary</mat-card-title>
      <mat-card-content>
        <div class="summary-item">
          <span class="label">Total Income</span>
          <span class="value">{{ totalIncome | currency }}</span>
        </div>
        <div class="summary-item">
          <span class="label">Total Expenses</span>
          <span class="value">{{ totalExpenses | currency }}</span>
        </div>
        <div class="summary-item">
          <span class="label">Profit Margin</span>
          <span class="value">{{ profitMargin | currency }} ({{ profitPercentage }})</span>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="section">
    <h2 class="section-title">Income</h2>
    <div class="filters">
      <mat-form-field appearance="outline">
        <mat-label>Category</mat-label>
        <mat-select [(ngModel)]="selectedIncomeCategory" (selectionChange)="applyFilters()">
          <mat-option value="all">All Categories</mat-option>
          <mat-option value="sales">Sales</mat-option>
          <mat-option value="subsidies">Subsidies</mat-option>
          <mat-option value="other">Other Income</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Period</mat-label>
        <mat-select [(ngModel)]="selectedIncomePeriod" (selectionChange)="applyFilters()">
          <mat-option value="all">All Periods</mat-option>
          <mat-option value="month">Month</mat-option>
          <mat-option value="quarter">Quarter</mat-option>
          <mat-option value="year">Year</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <app-income-table [incomeDataSource]="filteredIncomeDataSource"></app-income-table>
  </div>

  <div class="section">
    <h2 class="section-title">Expenses</h2>
    <div class="filters">
      <mat-form-field appearance="outline">
        <mat-label>Category</mat-label>
        <mat-select [(ngModel)]="selectedExpenseCategory" (selectionChange)="applyFilters()">
          <mat-option value="all">All Categories</mat-option>
          <mat-option value="supplies">Supplies</mat-option>
          <mat-option value="labor">Labor</mat-option>
          <mat-option value="maintenance">Maintenance</mat-option>
          <mat-option value="services">Services</mat-option>
          <mat-option value="other">Other Expenses</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Period</mat-label>
        <mat-select [(ngModel)]="selectedExpensePeriod" (selectionChange)="applyFilters()">
          <mat-option value="all">All Periods</mat-option>
          <mat-option value="month">Month</mat-option>
          <mat-option value="quarter">Quarter</mat-option>
          <mat-option value="year">Year</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <app-expense-table [expenseDataSource]="filteredExpenseDataSource"></app-expense-table>
  </div>

  <div class="section">
    <h2 class="section-title">Profitability Analysis</h2>
    <div class="roi">
      <span class="label">Return on Investment (ROI)</span>
      <span class="value">15%</span>
    </div>
    <app-profitability-table [profitabilityDataSource]="profitabilityDataSource"></app-profitability-table>
  </div>
</div>
